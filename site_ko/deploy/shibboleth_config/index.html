<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Seafile 시볼레스 인증 사용 설정 - Server Seafile Manual</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Seafile 시볼레스 인증 사용 설정";
    var mkdocs_page_input_path = "deploy/shibboleth_config.md";
    var mkdocs_page_url = "/deploy/shibboleth_config/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Server Seafile Manual</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Summary</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>도입부</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../README/">README</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>둘러보기</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/components/">Seafile 구성요소</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/file_permission_management/">파일 권한 관리</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">로드맵</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">자주 묻는 질문</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../changelog/">Changelog</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contribution/">기여하기</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Linux에서 Seafile 가동</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_sqlite/">Seafile과 SQLite 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_mysql/">Seafile과 MySQL 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_with_nginx/">Seahub와 Nginx 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../https_with_nginx/">Nginx https 활성화</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_with_apache/">Seahub와 Apache 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../https_with_apache/">Apache https 활성화</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_ldap/">Seafile LDAP 사용 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Seafile 시볼레스 인증 사용 설정</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#_1">둘러보기</a></li>
                
            
                <li class="toctree-l3"><a href="#_2">시볼레스 서비스 제공자 설치 및 설정</a></li>
                
            
                <li class="toctree-l3"><a href="#apache">Apache 설정</a></li>
                
            
                <li class="toctree-l3"><a href="#seahub">Seahub 설정</a></li>
                
            
                <li class="toctree-l3"><a href="#_3">검증</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../upgrade/">Seafile 서버 업그레이드</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>기타 가동 참고서</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../start_seafile_at_system_bootup/">시스템 부팅시 Seafile 시작하기</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_firewall/">방화벽 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_logrotate/">Logrotate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../add_memcached/">Memcached 추가</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_seafile_behind_nat/">NAT망에서 Seafile 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_seahub_at_non-root_domain/">비 루트 영역에서 Seafile 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../migrate_from_sqlite_to_mysql/">SQLite에서 MySQL로 이전</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">서버 설정 시 일반 문제</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../new_directory_layout_5_0_0/">Seafile 서버 5.0.0의 새 디렉터리 배치</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>윈도우에서 Seafile 가동</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_windows/">Deploy with windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/download_and_setup_seafile_windows_server/">Seafile 윈도우 서버 다운로드 및 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/using_ldap/">윈도우에서 Seafile LDAP 사용 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_mysql/">Seafile과 MySQL 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_apache/">Seafile과 Apache 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_apache/">Seafile과 Nginx 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/install_seafile_server_as_a_windows_service/">윈도우 서비스로 Seafile 서버 설치</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/ports_used_by_seafile_windows_server/">Seafile 윈도우 서버에서 사용하는 포트</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/upgrading_seafile_windows_server/">Seafile 윈도우 서버 업그레이드</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/migrate_from_win_to_linux/">윈도우에서 리눅스로 Seafile 옮기기</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_gc/">Seafile 서버 미사용 블록 가비지 콜렉션</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_fsck/">손상된 저장소에 대해 seaf-fsck 실행</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Seafile 전문가판 가동</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/download_and_setup_seafile_professional_server/">Seafile 전문가 서버 다운로드 및 설치</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/migrate_from_seafile_community_server/">Seafile 커뮤니티 서버에서 옮기기</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrading_seafile_professional_server/">Seafile 전문가 서버 업그레이드</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/using_ldap_pro/">Seafile 전문가판의 LDAP 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/ldap_group_sync/">LDAP에서 그룹 가져오기</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/configurable_options/">다중 단체 지원</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_documents_preview/">Office/PDF 문서 온라인 미리 보기 활성화</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_web_app/">오피스 웹 앱 통합</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/details_about_file_search/">파일 검색 세부 안내</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>바이러스 검사</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan/">Virus scan</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan_with_kav4fs/">kav4fs로 바이러스 검사</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/web_resumable_upload/">재개 가능한 웹 기반 파일 업로드</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>저장소 백엔드</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_amazon_s3/">아마존 S3 백엔드</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_ceph/">Ceph 백엔드</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_swift/">오픈스택 Swift 백엔드</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>클러스터 가동</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/deploy_in_a_cluster/">클러스터에서 가동</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/clustering_with_mariadb_ceph/">MariaDB와 Ceph 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_seafile_cluster_with_nfs/">NFS와 Seafile 클러스터 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/enable_search_and_background_tasks_in_a_cluster/">클러스터에서 검색 및 백그라운드 작업 활성화</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrade_a_cluster/">클러스터 업그레이드</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/real_time_backup/">실시간 백업 서버</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/configurable_options/">설정 가능 항목</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/faq_for_seafile_pro_server/">자주 묻는 질문</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/seafile_professional_sdition_software_license_agreement/">라이선스</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>서버 설정 및 개별 설정</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/ccnet-conf/">ccnet.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seafile-conf/">seafile.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_settings_py/">seahub_settings.py</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_customization/">Seahub 개별 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/desktop_customization/">Desktop 클라이언트 개별 설정</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/sending_email/">전자메일 보내기</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/user_options/">사용자 관리 설정 항목</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/quota_and_size_options/">저장소 용량 제한 및 파일 크기 제한</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>관리</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/account/">계정 관리</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/logs/">로그</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/backup_recovery/">백업 및 복원</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_fsck/">Seafile FSCK</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_gc/">Seafile GC</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/clean_database/">데이터베이스 정리</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>WebDAV 및 FUSE 확장 기능</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/webdav/">WebDAV 확장 기능</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/fuse/">FUSE 확장 기능</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>보안 및 감사</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/security_features/">보안 기능</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/auditing/">접근 기록 및 감사</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>개발</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/README/">README</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Seafile 빌드 방법</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/linux/">리눅스</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/freebsd/">FreeBSD</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/windows/">윈도우</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/osx/">Mac OS X</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/server/">서버</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/rpi/">라즈베리 파이</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/env/">개발 환경</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/code_standard/">코딩 표준</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api/">웹 API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api_v2.1/">웹 API V2.1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/python_api/">파이썬 API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/php_api/">PHP API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/data_model/">데이터 모델</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/server-components/">서버 구성 요소</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/sync_algorithm/">동기화 알고리즘</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Server Seafile Manual</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Linux에서 Seafile 가동 &raquo;</li>
        
      
    
    <li>Seafile 시볼레스 인증 사용 설정</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="_1">둘러보기</h2>
<p><a href="https://shibboleth.net/">Shibboleth</a> is a widely used single sign on (SSO) protocol. Seafile server (Community Edition &gt;= 4.1.0, Pro Edition &gt;= 4.0.6) supports authentication via Shibboleth. It allows users from another organization to log in to Seafile without registering an account on the service provider.</p>
<p>In this documentation, we assume the reader is familiar with Shibboleth installation and configuration. For introduction to Shibboleth concepts, please refer to https://wiki.shibboleth.net/confluence/display/SHIB2/UnderstandingShibboleth .</p>
<p>Shibboleth Service Provider (SP) should be installed on the same server as the Seafile server. The official SP from https://shibboleth.net/ is implemented as an Apache module. The module handles all Shibboleth authentication details. Seafile server receives authentication information (username) from fastcgi. The username then can be used as login name for the user.</p>
<p>Seahub provides a special URL to handle Shibboleth login. The URL is <code>https://your-server/shib-login</code>. Only this URL needs to be configured under Shibboleth protection. All other URLs don't go through the Shibboleth module. The overall workflow for a user to login with Shibboleth is as follows:</p>
<ol>
<li>In the Seafile login page, there is a separate "Shibboleth" login button. When the user clicks the button, she/he will be redirected to <code>https://your-server/shib-login</code>.</li>
<li>Since that URL is controlled by Shibboleth, the user will be redirected to IdP for login. After the user logs in, she/he will be redirected back to <code>https://your-server/shib-login</code>.</li>
<li>This time the Shibboleth module passes the request to Seahub. Seahub reads the user information from the request and brings the user to her/his home page.</li>
<li>All later access to Seahub will not pass through the Shibboleth module. Since Seahub keeps session information internally, the user doesn't need to login again until the session expires.</li>
</ol>
<p>Since Shibboleth support requires Apache, if you want to use Nginx, you need two servers, one for non-Shibboleth access, another configured with Apache to allow Shibboleth login. In a cluster environment, you can configure your load balancer to direct traffic to different server according to URL. Only the URL <code>https://your-server/shib-login</code> needs to be directed to Apache.</p>
<p>The configuration includes 3 steps:</p>
<ol>
<li>Install and configure Shibboleth Service Provider;</li>
<li>Configure Apache;</li>
<li>Configure Seahub.</li>
</ol>
<h2 id="_2">시볼레스 서비스 제공자 설치 및 설정</h2>
<p>Installation and configuration of Shibboleth is out of the scope of this documentation. Here are a few references:</p>
<ul>
<li>For RedHat and SUSE: https://wiki.shibboleth.net/confluence/display/SHIB2/NativeSPLinuxInstall</li>
<li>For Ubuntu: http://bradleybeddoes.com/2011/08/12/installing-a-shibboleth-2-sp-in-ubuntu-11-04-within-virtualbox/</li>
</ul>
<p>Please note that you don't have to follow the Apache configurations in the above links. Just use the Apache config we provide in the next section.</p>
<h2 id="apache">Apache 설정</h2>
<p>You should create a new virtual host configuration for Shibboleth.</p>
<pre><code>&lt;IfModule mod_ssl.c&gt;
    &lt;VirtualHost _default_:443&gt;
        ServerName seafile.example.com
        DocumentRoot /var/www
        #Alias /seafmedia  /home/ubuntu/dev/seahub/media
        Alias /media /home/user/seafile-server-latest/seahub/media

        ErrorLog ${APACHE_LOG_DIR}/seahub.error.log
        CustomLog ${APACHE_LOG_DIR}/seahub.access.log combined

        SSLEngine on
        SSLCertificateFile  /path/to/ssl-cert.pem
        SSLCertificateKeyFile /path/to/ssl-key.pem

        &lt;Location /Shibboleth.sso&gt;
        SetHandler shib
        &lt;/Location&gt;

        &lt;Location /api2&gt;
        AuthType None
        Require all granted
        Allow from all
        satisfy any
        &lt;/Location&gt;

        RewriteEngine On
        &lt;Location /media&gt;
        Require all granted
        &lt;/Location&gt;

        &lt;Location /shib-login&gt;
        AuthType shibboleth
        ShibRequestSetting requireSession true
        Require valid-user
        &lt;/Location&gt;

        #
        # seafile fileserver
        #
        ProxyPass /seafhttp http://127.0.0.1:8082
        ProxyPassReverse /seafhttp http://127.0.0.1:8082
        RewriteRule ^/seafhttp - [QSA,L]

        #
        # seahub
        #
        RewriteRule ^/(media.*)$ /$1 [QSA,L,PT]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_URI} !^/Shibboleth.sso
        RewriteRule ^(.*)$ /seahub.fcgi$1 [QSA,L,E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    &lt;/VirtualHost&gt;
&lt;/IfModule&gt;

</code></pre>

<p>After restarting Apache, you should be able to get the Service Provider metadata by accessing https://seafile.example.com/Shibboleth.sso/Metadata . This metadata should be uploaded to the Identity Provider (IdP) server.</p>
<h2 id="seahub">Seahub 설정</h2>
<p>Seahub extracts the username from the <code>REMOTE_USER</code> environment variable. So you should modify your SP's shibboleth2.xml (/etc/shibboleth/shibboleth2.xml on Ubuntu) config file, so that Shibboleth translates your desired attribute into <code>REMOTE_USER</code> environment variable.</p>
<pre><code>    &lt;ApplicationDefaults entityID=&quot;https://your-server/shibboleth&quot;
        REMOTE_USER=&quot;xxxx&quot;&gt;
</code></pre>

<p>In Seafile, only one of the following two attributes can be used for username: <code>eppn</code>, and <code>mail</code>. <code>eppn</code> stands for "Edu Person Principal Name". It is usually the UserPrincipalName attribute in Active Directory. It's not necessarily a valid email address. <code>mail</code> is the user's email address. You should set <code>REMOTE_USER</code> to either one of these attributes.</p>
<p>Now we have to tell Seahub how to do with the authentication information passed in by Shibboleth.</p>
<p>seahub_settings.py에 다음 설정 내용을 추가하십시오.</p>
<pre><code>EXTRA_AUTHENTICATION_BACKENDS = (
    'shibboleth.backends.ShibbolethRemoteUserBackend',
)
EXTRA_MIDDLEWARE_CLASSES = (
    'shibboleth.middleware.ShibbolethRemoteUserMiddleware',
)

ENABLE_SHIB_LOGIN = True

SHIBBOLETH_ATTRIBUTE_MAP = {
    # Change eppn to mail if you use mail attribute for REMOTE_USER
    &quot;eppn&quot;: (False, &quot;username&quot;),
}
</code></pre>

<p>Since version 5.0, Seahub can process additional user attributes from Shibboleth. These attributes are saved into Seahub's database, as user's properties. They're all not mandatory. The internal user properties Seahub now supports are:</p>
<ul>
<li>givenname</li>
<li>surname</li>
<li>contact_email: used for sending notification email to user if username is not a valid email address (like eppn).</li>
<li>institution: used to identify user's institution</li>
</ul>
<p>You can specify the mapping between Shibboleth attributes and Seahub's user properties in seahub_settings.py:</p>
<pre><code>SHIBBOLETH_ATTRIBUTE_MAP = {
    &quot;eppn&quot;: (False, &quot;username&quot;),
    &quot;givenname&quot;: (False, &quot;givenname&quot;),
    &quot;sn&quot;: (False, &quot;surname&quot;),
    &quot;mail&quot;: (False, &quot;contact_email&quot;),
    &quot;organization&quot;: (False, &quot;institution&quot;),
}
</code></pre>

<p>In the above config, the hash key is Shibboleth attribute name, the second element in the hash value is Seahub's property name. You can adjust the Shibboleth attribute name for your own needs. <strong><em>Note that you may have to change attribute-map.xml in your Shibboleth SP, so that the desired attributes are passed to Seahub. And you have to make sure the IdP sends these attributes to the SP.</em></strong></p>
<p>Since version 5.1.1, we added an option <code>SHIB_ACTIVATE_AFTER_CREATION</code> (defaults to <code>True</code>) which control the user status after shibboleth connection. If this option set to <code>False</code>, user will be inactive after connection, and system admins will be notified by email to activate that account.</p>
<h2 id="_3">검증</h2>
<p>After restarting Apache and Seafile services, you can then test the shibboleth login workflow.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../upgrade/" class="btn btn-neutral float-right" title="Seafile 서버 업그레이드">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../using_ldap/" class="btn btn-neutral" title="Seafile LDAP 사용 설정"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../using_ldap/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../upgrade/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
