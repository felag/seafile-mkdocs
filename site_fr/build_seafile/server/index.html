<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Server - Server Seafile Manual</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Server";
    var mkdocs_page_input_path = "build_seafile/server.md";
    var mkdocs_page_url = "/build_seafile/server/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Server Seafile Manual</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Summary</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Introduction</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../README/">README</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Overview</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/components/">Seafile Components</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/file_permission_management/">File permission management</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">Roadmap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">FAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../changelog/">Changelog</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contribution/">Contribution</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploying Seafile under Linux</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/using_sqlite/">Deploying Seafile with SQLite</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/using_mysql/">Deploying Seafile with MySQL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/deploy_with_nginx/">Config Seahub with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/https_with_nginx/">Enabling Https with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/deploy_with_apache/">Config Seahub with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/https_with_apache/">Enabling Https with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/using_ldap/">Configure Seafile to use LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/shibboleth_config/">Configure Seafile to use Shibboleth Authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/upgrade/">Upgrade Seafile server</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Other Deployment Notes</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/start_seafile_at_system_bootup/">Start Seafile at System Bootup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/using_firewall/">Firewall settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/using_logrotate/">Logrotate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/add_memcached/">Add Memcached</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/deploy_seafile_behind_nat/">Deploy Seafile behind NAT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/deploy_seahub_at_non-root_domain/">Deploy Seahub at Non-root domain</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/migrate_from_sqlite_to_mysql/">Migrate From SQLite to MySQL</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">Common Problems for Setting up Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy/new_directory_layout_5_0_0/">New Directory Layout in Seafile Server 5.0.0</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploy Seafile under Windows</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_windows/">Deploy with windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/download_and_setup_seafile_windows_server/">Download and Setup Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/using_ldap/">Configure Seafile to use LDAP on Windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_mysql/">Deploy Seafile with MySQL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_apache/">Deploy Seafile with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_nginx/">Deploy Seafile with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/install_seafile_server_as_a_windows_service/">Install Seafile Server as a Windows Service</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/ports_used_by_seafile_windows_server/">Ports used by Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/upgrading_seafile_windows_server/">Upgrading Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/migrate_from_win_to_linux/">Migrate Seafile From Windows To Linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_gc/">Garbage Collecting Unused Blocks on Seafile Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_fsck/">Running seaf-fsck on corrupted repositories</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploy Seafile Pro Edition</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/download_and_setup_seafile_professional_server/">Download and Setup Seafile Professional Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/migrate_from_seafile_community_server/">Migrate from Seafile Community Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrading_seafile_professional_server/">Upgrading Seafile Professional Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/using_ldap_pro/">LDAP Configuration for Seafile Pro</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/ldap_group_sync/">Importing Groups from LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/multi_institutions/">Multi-Institutions Support</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_documents_preview/">Enable Office/PDF Documents Online Preview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_web_app/">Integrating with Office Web App</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/details_about_file_search/">Details about File Search</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Virus Scan</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan/">Virus scan</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan_with_kav4fs/">Virus Scan With Kav4fs</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/web_resumable_upload/">Web Resumable File Upload</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Storage Backends</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_amazon_s3/">Amazon S3 Backend</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_ceph/">Ceph Backend</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_swift/">OpenStack Swift Backend</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Cluster Deployment</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/deploy_in_a_cluster/">Deploy in a cluster</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/clustering_with_mariadb_ceph/">Setup with MariaDB and Ceph</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_seafile_cluster_with_nfs/">Setup Seafile cluster with NFS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/enable_search_and_background_tasks_in_a_cluster/">Enable search and background tasks in a cluster</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrade_a_cluster/">Upgrade a cluster</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/real_time_backup/">Real-time Backup Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/configurable_options/">Configurable Options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/faq_for_seafile_pro_server/">FAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/seafile_professional_sdition_software_license_agreement/">License</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Server Configuration and Customization</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/ccnet-conf/">ccnet.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seafile-conf/">seafile.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_settings_py/">seahub_settings.py</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_customization/">Seahub customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/desktop_customization/">Desktop client customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/sending_email/">Email Sending</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/user_options/">User management options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/quota_and_size_options/">Storage Quota and File size limits</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Administration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/account/">Account management</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/logs/">Logs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/backup_recovery/">Backup and Recovery</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_fsck/">Seafile FSCK</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_gc/">Seafile GC</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/clean_database/">Clean database</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>WebDAV and FUSE extensions</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/webdav/">WebDAV extension</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/fuse/">FUSE extension</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Security and Auditing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/security_features/">Security features</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/auditing/">Access logs and auditing</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/README/">README</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>How to Build Seafile</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../linux/">Linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../freebsd/">FreeBSD</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../windows/">Windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../osx/">Mac OS X</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Server</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#server">Server</a></li>
                
                    <li><a class="toctree-l4" href="#preparation">Preparation</a></li>
                
                    <li><a class="toctree-l4" href="#deploy-seafile-server">Deploy Seafile Server</a></li>
                
                    <li><a class="toctree-l4" href="#upgrade-the-seafile-server">Upgrade the Seafile Server</a></li>
                
                    <li><a class="toctree-l4" href="#problems-report">Problems Report</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../rpi/">Raspberry Pi</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/env/">Develop env</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/code_standard/">Code Standard</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api/">Web API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api_v2.1/">Web API V2.1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/python_api/">Python API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/php_api/">PHP API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/data_model/">Data Model</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/server-components/">Server Components</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/sync_algorithm/">Sync algorithm</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Server Seafile Manual</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Developing &raquo;</li>
        
      
        
          <li>How to Build Seafile &raquo;</li>
        
      
    
    <li>Server</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="server">Server</h1>
<h2 id="preparation">Preparation</h2>
<p>The following list is all the libraries you need to install on your machine. <strong>You should install all of them before you build seafile</strong>.</p>
<p>Package names are according to Ubuntu 12.04. For other Linux distros, please find their corresponding names yourself.</p>
<ul>
<li>libevent-dev  (2.0 or later )</li>
<li>libcurl4-openssl-dev  (1.0.0 or later)</li>
<li>libglib2.0-dev (2.28 or later)</li>
<li>uuid-dev</li>
<li>intltool (0.40 or later)</li>
<li>libsqlite3-dev (3.7 or later)</li>
<li>libmysqlclient-dev (5.5 or later)</li>
<li>libarchive-dev</li>
<li>libtool</li>
<li>libjansson-dev</li>
<li>valac</li>
<li>libfuse-dev</li>
</ul>
<p>Also, python 2.7 is required since seafile server 5.1.0.</p>
<p>The following libraries need to be compiled from source.</p>
<h3 id="libzdb">libzdb</h3>
<ul>
<li>Install <code>re2c</code> and <code>flex</code></li>
<li>Download <a href="http://www.tildeslash.com/libzdb/dist/libzdb-2.12.tar.gz">libzdb</a></li>
</ul>
<h4 id="libevhtp">libevhtp</h4>
<ul>
<li>Download <a href="https://github.com/ellzey/libevhtp/archive/1.1.6.tar.gz">libevhtp</a>.</li>
<li>Build libevhtp by:</li>
</ul>
<pre><code>cmake -DEVHTP_DISABLE_SSL=ON -DEVHTP_BUILD_SHARED=ON .
make
sudo make install

</code></pre>

<h3 id="seahub-dependencies">Seahub dependencies</h3>
<p><strong>Seahub</strong> is the web front end of Seafile. It's written in the <a href="http://djangoproject.com">django</a> framework. Seahub requires Python 2.6(or 2.7) installed on your server, and it needs the following python libraries:</p>
<ul>
<li>Django 1.8</li>
<li>pytz</li>
<li>django-statici18n</li>
<li>djangorestframework</li>
<li>django_compressor</li>
<li>django-post_office</li>
<li><a href="https://github.com/haiwen/django-constance/">django-constance</a> (install it by <code>pip install https://github.com/haiwen/django-constance/archive/bde7f7c.zip</code>)</li>
<li>gunicorn</li>
<li>flup</li>
<li>chardet</li>
<li>python-dateutil</li>
<li>six</li>
<li>openpyxl</li>
</ul>
<p>Before continue, make sure you have all the above libraries available in your system.</p>
<h3 id="prepare-the-directory-layout">Prepare the directory layout</h3>
<p>In the following sections, you'll be guided to build and setup the seafile server step by step. Seafile server is consisted of several components. In order for them to function correctly, you must:</p>
<ul>
<li>Follow our instructions step by step</li>
<li>Make sure your directory layout is exactly the same with the guide in each step.</li>
</ul>
<p>First create the top level directory. In the following sections, we'll use "/data/haiwen" as the top level directory.</p>
<pre>
mkdir /data/haiwen/
cd /data/haiwen/
mkdir seafile-server
cd seafile-server
</pre>

<p>The currently layout is:</p>
<pre>
haiwen/
└── seafile-server
</pre>

<h3 id="get-the-source">Get the source</h3>
<p>First you should get the latest source of libsearpc/ccnet/seafile/seahub</p>
<p>Download the source tarball of the latest tag from</p>
<ul>
<li>https://github.com/haiwen/libsearpc/tags</li>
<li>https://github.com/haiwen/ccnet/tags</li>
<li>https://github.com/haiwen/seafile/tags</li>
<li>https://github.com/haiwen/seahub/tags</li>
</ul>
<p>For example, if the latest released seafile server is 4.4.7, then just use the <strong>v4.4.7-server</strong> tags of the projects (except for libsearpc, which uses the <strong>v3.0-latest</strong> tag). You should get four tarballs:</p>
<ul>
<li>libsearpc-3.0-latest.tar.gz</li>
<li>ccnet-4.4.7-server.tar.gz</li>
<li>seafile-4.4.7-server.tar.gz</li>
<li>seahub-4.4.7-server.tar.gz</li>
</ul>
<p>Create a folder <code>haiwen/src</code>, and uncompress libsearpc/ccnet/seafile source to it.</p>
<pre>
cd haiwen/seafile-server
mkdir src
cd src
tar xf /path/to/libsearpc-3.0-latest.tar.gz
tar xf /path/to/ccnet-4.4.7-server.tar.gz
tar xf /path/to/seafile-4.4.7-server.tar.gz
</pre>

<p>And uncompress seahub tarball to <code>haiwen/seafile-server</code>:</p>
<pre>
cd haiwen/seafile-server
tar xf /path/to/seahub-4.4.7-server.tar.gz
mv seahub-4.4.7-server seahub
</pre>

<p>So far, The current directory layout is:</p>
<pre>
haiwen/
└── seafile-server
    └── seahub
    └── src
        ├── libsearpc-4.4.7-server
        ├── ccnet-4.4.7-server
        ├── seafile-4.4.7-server
        ├── ... (other files)
</pre>

<h3 id="building">Building</h3>
<p>To build seafile server, you need first build <strong>libsearpc</strong> and <strong>ccnet</strong>.</p>
<h5 id="libsearpc">libsearpc</h5>
<pre>
cd libsearpc-${version}
./autogen.sh
./configure
make
make install
</pre>

<h5 id="ccnet">ccnet</h5>
<pre>
cd ccnet-${version}
./autogen.sh
./configure --disable-client --enable-server   # `export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig` if libsearpc is not found
make
make install
</pre>

<h5 id="seafile">seafile</h5>
<pre>
cd seafile-${version}
./autogen.sh
./configure --disable-client --enable-server
make
make install
</pre>

<p><em>Note</em>: You need to run <code>sudo ldconfig</code> to refresh the system libraries cache after you compiles all the components.</p>
<h2 id="deploy-seafile-server">Deploy Seafile Server</h2>
<h3 id="components-of-the-seafile-server">Components of the Seafile Server</h3>
<p>The seafile server consists of the following components:</p>
<table>
  <tr>
    <th>Process Name</th><th>Functionality</th>
  </tr>
  <tr>
    <td>ccnet-server</td><td>underlying networking</td>
  </tr>
  <tr>
    <td>seaf-server</td><td>data management</td>
  </tr>
  <tr>
    <td>Seahub</td><td>website front-end of seafile server</td>
  </tr>
  <tr>
    <td>fileserver</td><td>handles raw file upload/download for Seahub</td>
  </tr>
</table>

<p><img alt="server architecture" src="../../images/server-arch.png" title="server architecture" /></p>
<ul>
<li><strong>ccnet</strong> stores its configuration and metadata is a directory named <code>ccnet</code>.</li>
<li><strong>seaf-server</strong> store its configuration and data in a directory, normally named <code>seafile-data</code>.</li>
<li><strong>seahub</strong> is written in Django. If you have any experience with Django, you should know the <code>syncdb</code> command must be run to create all the database tables.</li>
<li>An <strong>admin account</strong> has to be created, so that you, the admin, can login with this account to manage the server.</li>
</ul>
<p>These are the essential steps to create the configuration:</p>
<ul>
<li>ensure seafile is already installed and all the python libraries seahub needs are installed.</li>
<li>create the ccnet configuration with the <strong>ccnet-init</strong> program</li>
<li>create the seafile configuration with <strong>seaf-server-init</strong> program</li>
<li>run Django <strong>syncdb</strong> command for seahub</li>
<li>create an admin account for the seafile server</li>
</ul>
<p>To create the configurations, you can either:</p>
<ul>
<li>use the seafile-admin script(see below)</li>
<li>[[create server configuration by hand]]</li>
</ul>
<h3 id="create-configurations-with-the-seafile-admin-script">Create Configurations with the seafile-admin script</h3>
<p><code>seafile-admin</code> should have been installed to system path after you have built and installed Seafile from source.
<pre>
usage: seafile-admin [-h] {setup,start,stop,reset-admin} ...</p>
<p>optional arguments:
  -h, --help            show this help message and exit</p>
<p>subcommands:</p>
<p>{setup,start,stop,reset-admin}
    setup               setup the seafile server
    start               start the seafile server
    stop                stop the seafile server
    reset-admin         reset seafile admin account
</pre></p>
<p>Go to the top level directory(in this guide it's <strong>/data/haiwen/</strong>), and run <strong>seafile-admin setup</strong> to create all the configuration:
<pre>
cd /data/haiwen
export PYTHONPATH=/data/haiwen/seafile-server/seahub/thirdpart
seafile-admin setup
</pre></p>
<p>The script would ask you a series of questions, and create all the configuration for you.</p>
<table>
  <tr>
    <th>Name</th><th>Usage</th><th>Default</th><th>Requirement</th>
  </tr>
  <tr>
    <td>server name</td>
    <td>The name of the server that would be shown on the client</td>
    <td></td>
    <td>3 ~ 15 letters or digits</td>
  </tr>
  <tr>
    <td>ip or domain</td>
    <td>The ip address or domain name of the server</td>
    <td></td>
    <td>Make sure to use the right ip or domain, or the client would have trouble connecting it</td>
  </tr>
  <tr>
  <td>ccnet port</td>
  <td>the tcp port used by ccnet</td>
  <td>10001</td>
  <td></td>
  </tr>
  <tr>
    <td>seafile port</td>
    <td>tcp port used by seafile</td>
    <td>12001</td>
    <td></td>
  </tr>
  <tr>
    <td>seafile fileserver port</td>
    <td>tcp port used by seafile fileserver</td>
    <td>8082</td>
    <td></td>
  </tr>
  <tr>
    <td>admin email</td>
    <td>Email address of the admin account</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>admin password</td>
    <td>password of the admin account</td>
    <td></td>
    <td></td>
  </tr>
</table>

<p>This is a screenshot of the <strong>seafile-admin setup</strong> command:
<img alt="admin setup running" src="../../images/seafile-admin-1.png" /></p>
<p>And a screenshot after setup is finished successfully:
<img alt="admin setup finished" src="../images/seafile-admin-2.png" /></p>
<p>At this time, the directory layout would be like this:
<pre>
haiwen/
└── ccnet # ccnet config directory
    └── ccnet.conf # ccnet config file
└── seafile-data # seafile configuration and data
    └── seafile.conf # seafile config file
└── seahub-data/ # seahub data
└── seahub.db # seahub sqlite3 database
└── seahub_settings.py # custom settings for seahub
└── seafile-server
    └── seahub/
    └── seafile-{VERSION} # seafile source code
</pre></p>
<h3 id="start-the-seafile-server">Start the Seafile Server</h3>
<p>After configuration successfully created, run <strong>seafile-admin start</strong> in the top directory to start the all components of Seafile. ( <strong>You should always run the seafile-admin script in the top directory</strong> ).</p>
<pre>
cd /data/haiwen # go to the top level directory
seafile-admin start
</pre>

<p>At this moment, all the components should be running and seahub can be visited at <strong>http://yourserver-ip-or-domain:8000</strong></p>
<p><strong>Note</strong> You may want to deploy seahub with nginx or apache. In this case, follow the instructions on Deploy Seafile Web With <a href="../../deploy/deploy_with_nginx/">Nginx</a>/<a href="../../deploy/deploy_with_apache/">Apache</a>.</p>
<h3 id="stop-the-seafile-server">Stop the Seafile Server</h3>
<p>To stop seafile server, run <strong>seafile-admin stop</strong>.</p>
<pre>
cd /data/haiwen # go to the top level directory
seafile-admin stop
</pre>

<h2 id="upgrade-the-seafile-server">Upgrade the Seafile Server</h2>
<p>When you want to upgrade to a new vesrion of seafile server, you need to:</p>
<ul>
<li>Stop the seafile server if it's running</li>
</ul>
<pre>
cd /data/haiwen
seafile-admin stop
</pre>

<ul>
<li>Get and latest source code and build libsearpc/ccnet/seafile, just as what you do in a fresh setup.</li>
<li>Run the upgrade script. The upgrade script mainly updates database used by seafile for you. For example, create a new database table that is used in the latest seafile server but not in the previous version.</li>
</ul>
<h3 id="get-and-compile-the-latest-libsearpcccnetseafile">Get and compile the latest libsearpc/ccnet/seafile</h3>
<p>See the <strong>Building</strong> section above.</p>
<h3 id="get-the-new-seahub-tarball-and-uncompress-it">Get the new seahub tarball and uncompress it</h3>
<pre>
cd haiwen/seafile-server
mv seahub/ seahub-old # move away the old seahub folder
tar xf /path/to/new/seahub-x.x.x-server.tar.gz
mv seahub-x.x.x-server seahub
</pre>

<h3 id="do-the-upgrade">Do the upgrade</h3>
<ul>
<li>copy the scripts/upgrade/ subdir outside</li>
</ul>
<p>The upgrade scripts is distributed in the <code>scripts/upgrade</code> subdir of seafile source code, we need to copy it to <strong>seafile-server</strong> directory before run the scripts.</p>
<pre>
cd /data/haiwen/seafile-server
cp -rf seafile-{version}/scripts/upgrade .
</pre>

<h4 id="continuous-upgrade-like-from-11-to-12">Continuous Upgrade (like from 1.1 to 1.2)</h4>
<p>Continuous upgrade means to upgrade from one version of seafile server to the next version. For example, upgrading from 1.1.0 to 1.2.0 is a continuous upgrade.</p>
<p><strong>Note:</strong> Minor upgrade, like upgrade from 1.3.0 to 1.3.1, is documented in a separate section below.</p>
<p>Say you are upgrading from 1.1.0 to 1.2.0, you should run the script <strong>upgrade_1.1_1.2.sh</strong> in <code>seafile-server</code> directory.</p>
<pre>
cd /data/haiwen/seafile-server
./upgrade/upgrade_1.1_1.2.sh
</pre>

<h4 id="non-continous-version-upgradelike-from-11-to-13">Non-continous version upgrade(like from 1.1 to 1.3)</h4>
<p>If you upgrade a few versions at once, e.g. from 1.1.0 to 1.3.0. The procedure is:</p>
<ul>
<li>upgrade from 1.1.0 to 1.2.0</li>
<li>upgrade from 1.2.0 to 1.3.0</li>
</ul>
<p>Just run the upgrade scripts in sequence.</p>
<h4 id="minor-upgrade-like-from-130-to-131">Minor Upgrade (like from 1.3.0 to 1.3.1)</h4>
<p>Minor upgrade Minor upgrade is like an upgrade from 1.3.0 to 1.3.1. For this type of upgrade, you only need to update the avatar link:</p>
<pre>
cd /data/haiwen/seafile-server/seahub/media
cp -rf avatars/* ../../../seahub-data/avatars/
rm -rf avatars
ln -s ../../../seahub-data/avatars
</pre>

<h2 id="problems-report">Problems Report</h2>
<p>If you encounter any problem when building/deploying Seafile, please leave us a message or <a href="https://github.com/haiwen/seafile/issues">open an issue</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../rpi/" class="btn btn-neutral float-right" title="Raspberry Pi">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../osx/" class="btn btn-neutral" title="Mac OS X"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../osx/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../rpi/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
