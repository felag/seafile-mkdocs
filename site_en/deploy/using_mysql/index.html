<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>Deploying Seafile with MySQL - Server Seafile Manual</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Deploying Seafile with MySQL";
    var mkdocs_page_input_path = "deploy/using_mysql.md";
    var mkdocs_page_url = "/deploy/using_mysql/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Server Seafile Manual</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Summary</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Introduction</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../README/">README</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Overview</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/components/">Seafile Components</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../overview/file_permission_management/">File permission management</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../roadmap/">Roadmap</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">FAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../changelog/">Changelog</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../contribution/">Contribution</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploying Seafile under Linux</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_sqlite/">Deploying Seafile with SQLite</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Deploying Seafile with MySQL</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#deploying-seafile-with-mysql">Deploying Seafile with MySQL</a></li>
                
                    <li><a class="toctree-l4" href="#download">Download</a></li>
                
                    <li><a class="toctree-l4" href="#deploying-and-directory-layout">Deploying and Directory Layout</a></li>
                
            
                <li class="toctree-l3"><a href="#tree-haiwen-l-2">tree haiwen -L 2</a></li>
                
                    <li><a class="toctree-l4" href="#prepare-mysql-databases">Prepare MySQL Databases</a></li>
                
                    <li><a class="toctree-l4" href="#setting-up-seafile-server">Setting Up Seafile Server</a></li>
                
                    <li><a class="toctree-l4" href="#running-seafile-server">Running Seafile Server</a></li>
                
                    <li><a class="toctree-l4" href="#stopping-and-restarting-seafile-and-seahub">Stopping and Restarting Seafile and Seahub</a></li>
                
                    <li><a class="toctree-l4" href="#performance-turning">Performance turning</a></li>
                
                    <li><a class="toctree-l4" href="#thats-it">That's it!</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_with_nginx/">Config Seahub with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../https_with_nginx/">Enabling Https with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_with_apache/">Config Seahub with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../https_with_apache/">Enabling Https with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_ldap/">Configure Seafile to use LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../shibboleth_config/">Configure Seafile to use Shibboleth Authentication</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../upgrade/">Upgrade Seafile server</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Other Deployment Notes</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../start_seafile_at_system_bootup/">Start Seafile at System Bootup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_firewall/">Firewall settings</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../using_logrotate/">Logrotate</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../add_memcached/">Add Memcached</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_seafile_behind_nat/">Deploy Seafile behind NAT</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../deploy_seahub_at_non-root_domain/">Deploy Seahub at Non-root domain</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../migrate_from_sqlite_to_mysql/">Migrate From SQLite to MySQL</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../faq/">Common Problems for Setting up Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../new_directory_layout_5_0_0/">New Directory Layout in Seafile Server 5.0.0</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploy Seafile under Windows</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_windows/">Deploy with windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/download_and_setup_seafile_windows_server/">Download and Setup Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/using_ldap/">Configure Seafile to use LDAP on Windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_mysql/">Deploy Seafile with MySQL</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_apache/">Deploy Seafile with Apache</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/deploy_with_nginx/">Deploy Seafile with Nginx</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/install_seafile_server_as_a_windows_service/">Install Seafile Server as a Windows Service</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/ports_used_by_seafile_windows_server/">Ports used by Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/upgrading_seafile_windows_server/">Upgrading Seafile Windows Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/migrate_from_win_to_linux/">Migrate Seafile From Windows To Linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_gc/">Garbage Collecting Unused Blocks on Seafile Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_windows/windows_fsck/">Running seaf-fsck on corrupted repositories</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Deploy Seafile Pro Edition</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/download_and_setup_seafile_professional_server/">Download and Setup Seafile Professional Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/migrate_from_seafile_community_server/">Migrate from Seafile Community Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrading_seafile_professional_server/">Upgrading Seafile Professional Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/using_ldap_pro/">LDAP Configuration for Seafile Pro</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/ldap_group_sync/">Importing Groups from LDAP</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/multi_institutions/">Multi-Institutions Support</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_documents_preview/">Enable Office/PDF Documents Online Preview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/office_web_app/">Integrating with Office Web App</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/details_about_file_search/">Details about File Search</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Virus Scan</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan/">Virus scan</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/virus_scan_with_kav4fs/">Virus Scan With Kav4fs</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/web_resumable_upload/">Web Resumable File Upload</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>Storage Backends</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_amazon_s3/">Amazon S3 Backend</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_ceph/">Ceph Backend</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_with_swift/">OpenStack Swift Backend</a>
        
    </li>

        
    </ul>

        
            
    <ul class="subnav">
    <li><span>Cluster Deployment</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/deploy_in_a_cluster/">Deploy in a cluster</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/clustering_with_mariadb_ceph/">Setup with MariaDB and Ceph</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/setup_seafile_cluster_with_nfs/">Setup Seafile cluster with NFS</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/enable_search_and_background_tasks_in_a_cluster/">Enable search and background tasks in a cluster</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/upgrade_a_cluster/">Upgrade a cluster</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/real_time_backup/">Real-time Backup Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/configurable_options/">Configurable Options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/faq_for_seafile_pro_server/">FAQ</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../deploy_pro/seafile_professional_sdition_software_license_agreement/">License</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Server Configuration and Customization</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/ccnet-conf/">ccnet.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seafile-conf/">seafile.conf</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_settings_py/">seahub_settings.py</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/seahub_customization/">Seahub customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/desktop_customization/">Desktop client customization</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/sending_email/">Email Sending</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/user_options/">User management options</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../config/quota_and_size_options/">Storage Quota and File size limits</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Administration</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/account/">Account management</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/logs/">Logs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/backup_recovery/">Backup and Recovery</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_fsck/">Seafile FSCK</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/seafile_gc/">Seafile GC</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../maintain/clean_database/">Clean database</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>WebDAV and FUSE extensions</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/webdav/">WebDAV extension</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../extension/fuse/">FUSE extension</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Security and Auditing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/security_features/">Security features</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../security/auditing/">Access logs and auditing</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developing</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/README/">README</a>
        
    </li>

        
            
    <ul class="subnav">
    <li><span>How to Build Seafile</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/README/">README</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/linux/">Linux</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/freebsd/">FreeBSD</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/windows/">Windows</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/osx/">Mac OS X</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/server/">Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../build_seafile/rpi/">Raspberry Pi</a>
        
    </li>

        
    </ul>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/env/">Develop env</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/code_standard/">Code Standard</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api/">Web API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/web_api_v2.1/">Web API V2.1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/python_api/">Python API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/php_api/">PHP API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/data_model/">Data Model</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/server-components/">Server Components</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../develop/sync_algorithm/">Sync algorithm</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Server Seafile Manual</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Deploying Seafile under Linux &raquo;</li>
        
      
    
    <li>Deploying Seafile with MySQL</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="deploying-seafile-with-mysql">Deploying Seafile with MySQL</h1>
<p>This manual explains how to setup and run seafile server from a pre-built package with MySQL.</p>
<h2 id="download">Download</h2>
<p><a href="http://www.seafile.com/en/download">Download</a> the latest server package.</p>
<h2 id="deploying-and-directory-layout">Deploying and Directory Layout</h2>
<p>Supposed your organization's name is "haiwen", and you've downloaded <code>seafile-server_1.8.2_*</code> into your home directory. We suggest you to layout your deployment as follows :</p>
<pre>
mkdir haiwen
mv seafile-server_* haiwen
cd haiwen
# after moving seafile-server_* to this directory
tar -xzf seafile-server_*
mkdir installed
mv seafile-server_* installed
</pre>

<p>Now you should have the following directory layout
<pre></p>
<h1 id="tree-haiwen-l-2">tree haiwen -L 2</h1>
<p>haiwen
├── installed
│   └── seafile-server_1.8.2_x86-64.tar.gz
└── seafile-server-1.8.2
    ├── reset-admin.sh
    ├── runtime
    ├── seafile
    ├── seafile.sh
    ├── seahub
    ├── seahub.sh
    ├── setup-seafile.sh
    └── upgrade
</pre></p>
<p>The benefit of this layout is that:</p>
<ul>
<li>We can place all the config files for Seafile server inside "haiwen" directory, making it easier to manage.</li>
<li>When you upgrade to a new version of Seafile, you can simply untar the latest package into "haiwen" directory. In this way you can reuse the existing config files in "haiwen" directory and don't need to configure again.</li>
</ul>
<h2 id="prepare-mysql-databases">Prepare MySQL Databases</h2>
<p>Three components of Seafile Server need their own databases:</p>
<ul>
<li>ccnet server</li>
<li>seafile server</li>
<li>seahub</li>
</ul>
<p>See <a href="components.md">Seafile Server Components Overview</a> if you want to know more about the seafile server components.</p>
<p>There are two ways to intialize the databases:</p>
<ul>
<li>let the <code>setup-seafile-mysql.sh</code> script create the databases for you.</li>
<li>create the databases by yourself, or someone else (the database admin, for example)</li>
</ul>
<p>We recommend the first way. The script would ask you for the root password of the mysql server, and it will create:</p>
<ul>
<li>database for ccnet/seafile/seahub.</li>
<li>a new user to access these databases</li>
</ul>
<p>However, sometimes you have to use the second way. If you don't have the root password, you need someone who has the privileges, e.g., the database admin, to create the three databases, as well as a mysql user who can access the three databases for you. For example, to create three databases: <code>ccnet-db</code> / <code>seafile-db</code> / <code>seahub-db</code> for ccnet/seafile/seahub respectively, and a mysql user "seafile" to access these databases:</p>
<pre>
create database `ccnet-db` character set = 'utf8';
create database `seafile-db` character set = 'utf8';
create database `seahub-db` character set = 'utf8';

create user 'seafile'@'localhost' identified by 'seafile';

GRANT ALL PRIVILEGES ON `ccnet-db`.* to `seafile`@localhost;
GRANT ALL PRIVILEGES ON `seafile-db`.* to `seafile`@localhost;
GRANT ALL PRIVILEGES ON `seahub-db`.* to `seafile`@localhost;
</pre>

<h2 id="setting-up-seafile-server">Setting Up Seafile Server</h2>
<h3 id="prerequisites">Prerequisites</h3>
<p>The Seafile server package requires the following packages have been installed in your system</p>
<ul>
<li>python 2.7</li>
<li>python-setuptools</li>
<li>python-imaging</li>
<li>python-ldap</li>
<li>python-mysqldb</li>
<li>python-memcache (or python-memcached)</li>
</ul>
<pre>
# on Debian/Ubuntu
apt-get update
apt-get install python2.7 libpython2.7 python-setuptools python-imaging \
  python-ldap python-mysqldb python-memcache
</pre>

<pre>
# on CentOS 7
sudo yum install python-imaging MySQL-python python-memcached python-ldap
</pre>

<h3 id="setup">Setup</h3>
<pre>
cd seafile-server-*
./setup-seafile-mysql.sh  #run the setup script & answer prompted questions
</pre>

<p>If some of the prerequisites are not installed, the seafile initialization script will ask you to install them.</p>
<p>The script will guide you through the settings of various configuration options.</p>
<p><strong> Seafile configuration options </strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>server name</td>
<td>Name of this seafile server</td>
<td>3-15 characters, only English letters, digits and underscore ('_') are allowed</td>
</tr>
<tr>
<td>server ip or domain</td>
<td>The IP address or domain name used by this server</td>
<td>Seafile client program will access the server with this address</td>
</tr>
<tr>
<td>seafile data dir</td>
<td>Seafile stores your data in this directory. By default it'll be placed in the current directory.</td>
<td>The size of this directory will increase as you put more and more data into Seafile. Please select a disk partition with enough free space.</td>
</tr>
<tr>
<td>fileserver port</td>
<td>The TCP port used by Seafile fileserver</td>
<td>Default is 8082. If it's been used by other service, you can set it to another port.</td>
</tr>
</tbody>
</table>
<p>At this moment, you will be asked to choose a way to initialize seafile databases:</p>
<pre><code class="sh">-------------------------------------------------------
Please choose a way to initialize seafile databases:
-------------------------------------------------------

[1] Create new ccnet/seafile/seahub databases
[2] Use existing ccnet/seafile/seahub databases

</code></pre>

<p>Which one to choose depends on if you have the root password.</p>
<ul>
<li>If you choose "1", you need to provide the root password. The script would create the databases and a new user to access the databases</li>
<li>If you choose "2", the ccnet/seafile/seahub databases must have already been created, either by you, or someone else.</li>
</ul>
<p>If you choose "[1] Create new ccnet/seafile/seahub databases", you would be asked these questions:</p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Description</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>mysql server host</td>
<td>the host address of the mysql server</td>
<td>the default is localhost</td>
</tr>
<tr>
<td>mysql server port</td>
<td>the port of the mysql server</td>
<td>the default is 3306. Almost every mysql server uses this port.</td>
</tr>
<tr>
<td>root password</td>
<td>the password of mysql root account</td>
<td>the root password is required to create new databases and a new user</td>
</tr>
<tr>
<td>mysql user for seafile</td>
<td>the username for seafile programs to use to access MySQL server</td>
<td>if the user does not exist, it would be created</td>
</tr>
<tr>
<td>password for seafile mysql user</td>
<td>the password for the user above</td>
<td></td>
</tr>
<tr>
<td>ccnet dabase name</td>
<td>the name of the database used by ccnet, default is "ccnet-db"</td>
<td>the database would be created if not existing</td>
</tr>
<tr>
<td>seafile dabase name</td>
<td>the name of the database used by seafile, default is "seafile-db"</td>
<td>the database would be created if not existing</td>
</tr>
<tr>
<td>seahub dabase name</td>
<td>the name of the database used by seahub, default is "seahub-db"</td>
<td>the database would be created if not existing</td>
</tr>
</tbody>
</table>
<p>If you choose "[2] Use existing ccnet/seafile/seahub databases", you would be asked these questions:</p>
<p><strong> related questions for "Use existing ccnet/seafile/seahub databases" </strong></p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Description</th>
<th>Note</th>
</tr>
</thead>
<tbody>
<tr>
<td>mysql server host</td>
<td>the host address of the mysql server</td>
<td>the default is localhost</td>
</tr>
<tr>
<td>mysql server port</td>
<td>the port of the mysql server</td>
<td>the default is 3306. Almost every mysql server uses this port</td>
</tr>
<tr>
<td>mysql user for seafile</td>
<td>the user for seafile programs to use to access MySQL server</td>
<td>the user must already exists</td>
</tr>
<tr>
<td>password for seafile mysql user</td>
<td>the password for the user above</td>
<td></td>
</tr>
<tr>
<td>ccnet dabase name</td>
<td>the name of the database used by ccnet</td>
<td>this database must already exist</td>
</tr>
<tr>
<td>seafile dabase name</td>
<td>the name of the database used by seafile, default is "seafile-db"</td>
<td>this database must already exist</td>
</tr>
<tr>
<td>seahub dabase name</td>
<td>the name of the database used by seahub, default is "seahub-db"</td>
<td>this database must already exist</td>
</tr>
</tbody>
</table>
<p>If the setup is successful, you'll see the following output</p>
<p><img alt="server-setup-succesfully" src="../../images/Server-setup-successfully.png" /></p>
<p>Now you should have the following directory layout :</p>
<pre><code class="sh">#tree haiwen -L 2
haiwen
├── ccnet               # configuration files
│   ├── mykey.peer
│   ├── PeerMgr
│   └── seafile.ini
├── conf
│   └── ccnet.conf
│   └── seafile.conf
│   └── seahub_settings.py
├── installed
│   └── seafile-server_1.8.2_x86-64.tar.gz
├── seafile-data
├── seafile-server-1.8.2  # active version
│   ├── reset-admin.sh
│   ├── runtime
│   ├── seafile
│   ├── seafile.sh
│   ├── seahub
│   ├── seahub.sh
│   ├── setup-seafile.sh
│   └── upgrade
├── seafile-server-latest  # symbolic link to seafile-server-1.8.2
├── seahub-data
│   └── avatars
</code></pre>

<p>The folder <code>seafile-server-latest</code> is a symbolic link to the current seafile server folder. When later you upgrade to a new version, the upgrade scripts would update this link to keep it always point to the latest seafile server folder.</p>
<h2 id="running-seafile-server">Running Seafile Server</h2>
<h3 id="starting-seafile-server-and-seahub-website">Starting Seafile Server and Seahub Website</h3>
<p>Under seafile-server-1.8.2 directory, run the following commands</p>
<pre><code>./seafile.sh start # Start seafile service
./seahub.sh start &lt;port&gt;  # Start seahub website, port defaults to 8000
</code></pre>

<p>Note: The first time you start seahub, the script would prompt you to create an admin account for your seafile server.</p>
<p>After starting the services, you may open a web browser and visit Seafile web interface at (assume your server IP is 192.168.1.111):</p>
<pre><code>http://192.168.1.111:8000/
</code></pre>

<p>Congratulations! Now you have successfully setup your private Seafile server.</p>
<h3 id="run-seahub-on-another-port">Run Seahub on another port</h3>
<p>If you want to run seahub in a port other than the default 8000, say 8001, you must:</p>
<ul>
<li>
<p>stop the seafile server
<pre>
./seahub.sh stop
./seafile.sh stop
</pre></p>
</li>
<li>
<p>modify the value of <code>SERVICE_URL</code> in the file <a href="../../config/ccnet-conf/">ccnet.conf</a>, like this: (assume your ip or domain is <code>192.168.1.111</code>)
<pre>
SERVICE_URL = http://192.168.1.111:8001
</pre></p>
</li>
<li>
<p>restart seafile server
<pre>
./seafile.sh start
./seahub.sh start 8001
</pre></p>
</li>
</ul>
<p>see <a href="server_configuration.md">Seafile server configuration options</a> for more details about <code>ccnet.conf</code>.</p>
<h2 id="stopping-and-restarting-seafile-and-seahub">Stopping and Restarting Seafile and Seahub</h2>
<h4 id="stopping">Stopping</h4>
<pre>
./seahub.sh stop # stop seahub website
./seafile.sh stop # stop seafile processes
</pre>

<h4 id="restarting">Restarting</h4>
<pre>
./seafile.sh restart
./seahub.sh restart
</pre>

<h4 id="when-the-scripts-fail">When the Scripts Fail</h4>
<p>Most of the time, seafile.sh and seahub.sh work fine. But if they fail, you may</p>
<ul>
<li>Use <code>pgrep</code> command to check if seafile/seahub processes are still running</li>
</ul>
<pre>
pgrep -f seafile-controller # check seafile processes
pgrep -f "manage.py run_gunicorn" # check seahub process
</pre>

<ul>
<li>Use <code>pkill</code> to kill the processes</li>
</ul>
<pre>
pkill -f seafile-controller
pkill -f "manage.py run_gunicorn"
</pre>

<h2 id="performance-turning">Performance turning</h2>
<p>If you have more than 50 users in your Seafile system, we highly recommand you to <a href="../add_memcached/">add memcached</a>. This will make the web 10x faster.  </p>
<h2 id="thats-it">That's it!</h2>
<p>That's it! Now you may want read more about seafile.</p>
<ul>
<li><a href="../deploy_with_nginx/">Deploy Seafile with Nginx</a> / <a href="../deploy_with_apache/">Deploy Seafile with Apache</a></li>
<li><a href="../https_with_nginx/">Enable Https on Seafile Web with Nginx</a> / <a href="../https_with_apache/">Enable Https on Seafile Web with Apache</a></li>
<li><a href="../using_ldap/">Configure Seafile to use LDAP</a></li>
<li><a href="../../maintain/README/">How to manage the server</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../deploy_with_nginx/" class="btn btn-neutral float-right" title="Config Seahub with Nginx">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../using_sqlite/" class="btn btn-neutral" title="Deploying Seafile with SQLite"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../using_sqlite/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../deploy_with_nginx/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
